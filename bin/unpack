#!/bin/bash

(( $# != 1 )) && echo "Usage: $(basename $0) FILENAME" && exit 1

FILE="$1"
[ ! -f "$FILE" ] && echo "Could not find file '$FILE', Aborting." && exit 1
INFO="$(file "$FILE")"

is_rar()
{
    echo "$INFO" | grep -q "RAR archive data" && return 0
    return 1
}

is_tar()
{
    echo "$INFO" | grep -q "tar archive" && return 0
    return 1
}

is_gzip()
{
    echo "$INFO" | grep -q "gzip compressed data" && return 0
    return 1
}

is_bzip2()
{
    echo "$INFO" | grep -q "bzip2 compressed data" && return 0
    return 1
}

is_7za()
{
    echo "$INFO" | grep -q "7-zip archive data" && return 0
    return 1
}

is_zip()
{
    echo "$INFO" | grep -q "Zip archive data" && return 0
    return 1 
}

is_rar && unrar x "$FILE" && exit 0
is_7za && 7za x "$FILE" && exit 0
is_gzip && gunzip -dc $FILE | tar -xf - && exit 0
is_bzip2 && bunzip2 -dc $FILE | tar -xf - && exit 0
is_tar && tar xvf "$FILE" && exit 0
is_zip && unzip "$FILE" && exit 0

echo "Failed to unpack: $INFO"
exit 1

